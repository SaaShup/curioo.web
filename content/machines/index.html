<div class="container">
    <div id="map" style="height: 800px;" class="my-3">
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script type='text/javascript' src='https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js'>
    </script>
    <script type="text/javascript">
        var machineIcon = L.icon({
            iconUrl: '/images/machine.png',
            iconSize:     [48, 48]
        });
        var lat = 48.689958;
        var lon = 6.174794;
        var macarte = null;
        var markerClusters;
        var cards = {};
        function initMap() {
            macarte = L.map('map').setView([lat, lon], 6);
            L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
                attribution: 'curioomachines',
                minZoom: 6,
                maxZoom: 15
            }).addTo(macarte);
            let c = 0;
            for (const card of cards.cards) {
                if (card.lat !== null && card.lon !== null) {
                    console.log(card)
                    var marker = L.marker([card.lat, card.lon], {icon: machineIcon});
                    marker.bindPopup('<div class="text-center"><div class="fw-bold m-2">' + card.place + '</div><div><img class="rounded" width="96px" height="96px" src="/images/cards/2025/' + card.card_id + '-min.png"/></div></div>');
                    marker.addTo(macarte);
                    c++;
                }
            }
        }
        window.onload = async function () {
            const response = await fetch("https://api.curioo.city/api/cards/2025");
            cards = await response.json();
            initMap();
        };
    </script>
</div>
